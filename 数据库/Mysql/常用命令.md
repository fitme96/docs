使用容器客户端工具

docker run -it --rm mysql:5.7 mysql -h192.168.65.8 -uroot -psec197011

非交互式执行SQL

mysql -uroot -pYHlie4/wMd5u bugfeel -e 'delete from result_tamper where id = 905916'

统计行数

select count(1) from result_tamper where id < 905917

查看表占用空间

select table_schema as '数据库', table_name as '表名', table_rows as '记录数', truncate(data_length/1024/1024, 2) as '数据容量(MB)', truncate(index_length/1024/1024, 2) as '索引容量(MB)' from information_schema.tables order by data_length asc, index_length asc;

### 备份恢复

排除指定表备份test数据库，排除多个使用多个--ignore-table

nohup mysqldump --max-allowed-packet=512M -uroot -pYHlie4/wMd5u test_db --ignore-table=test.table > /test.sql &

备份单表指定时间段数据

mysqldump --max-allowed-packet=512M -uroot -pYHlie4/wMd5u test_db test_table --where date > '2023-01-01 00:00:00' > /backup/test.sql

问题
ERROR 2006 (HY000) at line 1: MySQL server has gone away
```shell
my.cnf增加max_allowed_packet=64M
docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=sec197011 mysql:5.7.33 --max-allowed-packet=67108864

SET GLOBAL bulk_insert_buffer_size = 1024*1024*512;
```
